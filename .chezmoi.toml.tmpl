{{- /*
  .chezmoi.toml.tmpl
  Initialization template for chezmoi init
  Prompts:
    - profile (default: "butterfly")
  Auto-detects has_battery by probing common power_supply paths
*/ -}}

{{- $profile := promptStringOnce . "profile" "Which machine profile are you configuring? (butterfly/garden)" "butterfly" -}}
{{- $hasBattery := or (stat "/sys/class/power_supply/BAT0") (stat "/sys/class/power_supply/BAT1") (stat "/sys/class/power_supply/BAT") -}}

encryption = "age"

[age]
    identity = "~/.config/chezmoi/key.txt"
    recipients = ["age1q3zeqpem8ekgmrgcpj84x4f488gn99tf3af3n005nqwrlh7mpumsa6tfq8"]

[data]
profile = {{ $profile | quote }}
has_battery = {{ if $hasBattery }}true{{ else }}false{{ end }}
